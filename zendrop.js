


// // Upsell
// // Upsell
// document.addEventListener('DOMContentLoaded', function () {
//   var upsellProducts = document.querySelectorAll('.upsell-product__checkbox input[type="checkbox"]');
//   var checkoutButton = document.getElementById('CartDrawer-Checkout');
//   var cartDrawer = document.querySelector('cart-drawer');

//   // Function to refresh the cart drawer
//   function refreshCartDrawer() {
//     fetch('/cart.js')
//       .then(function (response) {
//         return response.json();
//       })
//       .then(function (cart) {
//         // Update the cart drawer with the latest cart data
//         var cartDrawerContent = document.querySelector('.drawer__inner');
//         cartDrawerContent.innerHTML = '';

//         // Render the updated cart items
//         cart.items.forEach(function (item) {
//           // Render each cart item in the drawer
//           // You can use your existing cart item rendering logic here
//         });

//         // Update the upsell selection state based on the cart data
//         upsellProducts.forEach(function (product) {
//           var productId = product.getAttribute('data-product-id');
//           var isInCart = cart.items.some(function (item) {
//             return item.product_id === parseInt(productId);
//           });
//           product.checked = isInCart;
//         });
//       })
//       .catch(function (error) {
//         console.error('Error refreshing cart drawer:', error);
//       });
//   }

//   checkoutButton.addEventListener('click', function (event) {
//     event.preventDefault();

//     var selectedUpsellProducts = Array.from(upsellProducts).filter(function (product) {
//       return product.checked;
//     });

//     if (selectedUpsellProducts.length > 0) {
//       var items = selectedUpsellProducts.map(function (product) {
//         return {
//           id: product.value,
//           quantity: 1
//         };
//       });

//       fetch('/cart/add.js', {
//         method: 'POST',
//         headers: {
//           'Content-Type': 'application/json'
//         },
//         body: JSON.stringify({ items: items })
//       })
//         .then(function (response) {
//           return response.json();
//         })
//         .then(function (data) {
//           console.log('Upsell products added to cart:', data);
//           refreshCartDrawer(); // Refresh the cart drawer after adding upsell products
//           window.location.href = '/checkout';
//         })
//         .catch(function (error) {
//           console.error('Error adding upsell products to cart:', error);
//           window.location.href = '/checkout';
//         });
//     } else {
//       window.location.href = '/checkout';
//     }
//   });
// });